# Shared (all services)
# Local dev: `npm run dev` reads `.env.local` (gitignored). Copy this file to `.env.local` to override defaults.
# Docker: docker-compose reads `.env` from repo root (optional) and injects variables into containers.
# DATABASE_URL="file:/data/dev.db"
# NOTE: docker-compose 会自动读取根目录的 .env，并把变量注入容器。
DATABASE_URL="file:/data/dev.db"
JWT_SECRET="dev-secret-change-me"

# API
API_PORT="3001"

# Web (Next rewrite target, used by next.config.ts)
API_URL="http://api:3001"
WEB_PORT="3000"

# Worker (安全默认：使用模拟 executor + mock market-data；显式 opt-in 才能 real)
WORKER_ENABLED="true"
WORKER_INTERVAL_MS="10000"
WORKER_MAX_BOTS="100"
WORKER_CACHE_MAX="100"
WORKER_ENABLE_TRADING="true"
WORKER_ENABLE_STOPPING="true"
WORKER_USE_REAL_EXCHANGE="false"
# Market data provider:
# - sim: local simulated ticker (no network) - recommended for dev
# - mock: fixed ticker (deterministic)
# - real: ccxt/binance public market data (network)
EXCHANGE_PROVIDER="sim"

# ccxt proxy (optional, for restricted networks)
# - socks5h://127.0.0.1:10809 (common local SOCKS5)
# - http://127.0.0.1:10808 (common local HTTP)
# CCXT_PROXY_URL="socks5h://127.0.0.1:10809"
# Optional: bypass proxy for specific hosts (comma-separated). Also respects NO_PROXY/no_proxy.
# Example: Binance spot testnet returns 451 in some proxy egress regions.
# CCXT_NO_PROXY="testnet.binance.vision"

# Retry / backoff (V1)
WORKER_ORDER_MAX_RETRIES="5"
WORKER_ORDER_BACKOFF_BASE_MS="1000"
WORKER_ORDER_BACKOFF_MAX_MS="30000"
WORKER_STOP_MAX_RETRIES="5"
WORKER_STOP_BACKOFF_BASE_MS="1000"
WORKER_STOP_BACKOFF_MAX_MS="30000"

# API logging (default: errors only)
# LOG_HTTP="errors"        # all | errors | slow | none
# LOG_HTTP_SLOW_MS="1000"  # only used when LOG_HTTP=slow (ms)

# Real trading safety rails (MUST stay false unless you know what you are doing)
ALLOW_MAINNET_TRADING="false"

# Credentials encryption (required for mainnet accounts; optional for testnet)
# CREDENTIALS_ENCRYPTION_KEY="<32-byte base64 key>"

# ============================================================================
# Observability & Alerts (Phase 7)
# ============================================================================

# Prometheus metrics are exposed at /metrics endpoint by default

# Telegram alerts (optional)
# TELEGRAM_BOT_TOKEN="your-bot-token"
# TELEGRAM_CHAT_ID="your-chat-id"

# Webhook alerts (optional, any HTTP endpoint that accepts POST JSON)
# ALERT_WEBHOOK_URL="https://your-webhook.example.com/alerts"

# PushPlus alerts (optional, for WeChat push)
# PUSHPLUS_TOKEN="your-pushplus-token"

# Alert throttling (ms) - same alert won't fire twice within this window
ALERT_THROTTLE_MS="60000"

# Global alerts switch
ALERTS_ENABLED="true"
